<script setup>

import {ref} from "vue";
import axios from "axios";
import router from "@/router";

defineProps({
  isLogged: Boolean,
  infoProfile: ref([])
})

const token = ref(sessionStorage.getItem('token'))

const logOut = async () => {
  try {
    // const token = sessionStorage.getItem('token'); // Reemplaza con tu token real

    // content.value = `email=${formData.value.email} &password=${formData.value.password}`
    // const content = `token=`

    console.log("Token: " , sessionStorage.getItem('token'))
    // 'Authorization': Bearer ${localStorage.getItem('access_token')}
    const config = {
      headers: {
        Accept: 'application/json',
        // Authorization: `Bearer ${token}`,
        'Authorization': `Bearer ${sessionStorage.getItem('token')}`
      },
    };

    const response = await axios.get('http://localhost/demo-bret/public/api/logout', config);
    console.log("Response del LotOut", response)
    // Realiza otras operaciones con la respuesta si es necesario.
    sessionStorage.clear()
    location.reload()
    await router.push('/')

  } catch (error) {
    console.error('Error con cargar datos del profile: ', error);
  }
};

</script>

<template>
  <!--Navbar Start-->
  <div class="col-12 p-0 m-0">
    <nav class="navbar navbar-expand-lg ff-popins pt-3">
      <div class="col-10 container-fluid">
        <RouterLink  to="/" class="navbar-brand hvr-grow" href="#"><img src="@/assets/img/logo-profile2.png" alt="Logo Bre.T"></RouterLink>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown"
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <p class="btn-navprofile mb-0"><i class="bi bi-list text-dark list-profile"></i></p>
        <div class="collapse navbar-collapse d-flex justify-content-between" id="navbarNavDarkDropdown">
          <ul class="navbar-nav">
            <!--<li class="nav-item">
              <a  v-if="isLogged" class="nav-link active text-dark fw-light fs-5 hvr-underline-from-left custom-mg" aria-current="page" href="#">Ofertas</a>
              <a v-else class="nav-link active text-dark fw-light fs-5 hvr-underline-from-left custom-mg" href="#" >Contratar</a>
            </li>
            <li class="nav-item">
              <a v-if="isLogged" class="nav-link active text-dark fw-light fs-5 hvr-underline-from-left" aria-current="page" href="#">Configuraciones</a>
            </li>-->
          </ul>
          <ul class="navbar-nav gap-4 align-items-center">
            <li v-if="token" class="nav-item">
              <RouterLink
                  @click="logOut"
                  class="nav-link active hvr-underline-from-left fw-light fs-5 text-dark" to="/">Cerrar Sesi√≥n</RouterLink>
            </li>
            <li class="nav-item">
              <a class="nav-link active hvr-underline-from-left text-white fw-light fs-5" aria-current="page" href=""><svg xmlns="http://www.w3.org/2000/svg" width="35" height="34" viewBox="0 0 35 34" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M31.598 6.80513C33.5878 9.46027 34.7571 12.6396 34.9618 15.9513V26.9237C34.9599 28.7999 34.2138 30.5987 32.8871 31.9253C31.5605 33.252 29.7617 33.9981 27.8855 34H18.0028C14.6848 34.0017 11.4389 33.0324 8.66514 31.2116C5.89139 29.3908 3.71109 26.7981 2.39304 23.7532C1.07499 20.7082 0.676801 17.3441 1.24757 14.0756C1.81834 10.8071 3.33311 7.77705 5.60514 5.35902C7.87717 2.94099 10.8071 1.24069 14.0338 0.467736C17.2605 -0.305221 20.6429 -0.117044 23.7639 1.00907C26.8849 2.13518 29.6082 4.15 31.598 6.80513ZM30.8877 29.9259C31.6839 29.1297 32.1313 28.0498 32.1313 26.9237V16.0857C32.0009 14.1662 31.4822 12.293 30.6064 10.5799C29.7306 8.86677 28.516 7.34932 27.0364 6.11955C24.5028 4.00786 21.3067 2.85547 18.0085 2.86447C17.3934 2.86527 16.779 2.90403 16.1686 2.98052C13.04 3.39393 10.1378 4.83685 7.91977 7.08181C5.70172 9.32677 4.29389 12.2461 3.91823 15.3795C3.68033 17.3661 3.86991 19.3806 4.47428 21.2879C5.07864 23.1952 6.08381 24.9513 7.42239 26.4383C8.75453 27.9261 10.3853 29.1164 12.2083 29.9316C14.0314 30.7468 16.0058 31.1686 18.0028 31.1695H27.8855C29.0116 31.1695 30.0915 30.7222 30.8877 29.9259ZM17.9786 12.7712H12.3176C11.9423 12.7712 11.5823 12.6221 11.3169 12.3567C11.0515 12.0913 10.9024 11.7313 10.9024 11.356C10.9024 10.9806 11.0515 10.6207 11.3169 10.3552C11.5823 10.0898 11.9423 9.94073 12.3176 9.94073H17.9786C18.354 9.94073 18.714 10.0898 18.9794 10.3552C19.2448 10.6207 19.3939 10.9806 19.3939 11.356C19.3939 11.7313 19.2448 12.0913 18.9794 12.3567C18.714 12.6221 18.354 12.7712 17.9786 12.7712ZM12.3176 15.6017C11.9423 15.6017 11.5823 15.7508 11.3169 16.0162C11.0515 16.2817 10.9024 16.6416 10.9024 17.017C10.9024 17.3923 11.0515 17.7523 11.3169 18.0177C11.5823 18.2831 11.9423 18.4322 12.3176 18.4322H23.6397C24.015 18.4322 24.375 18.2831 24.6404 18.0177C24.9058 17.7523 25.0549 17.3923 25.0549 17.017C25.0549 16.6416 24.9058 16.2817 24.6404 16.0162C24.375 15.7508 24.015 15.6017 23.6397 15.6017H12.3176ZM11.3169 21.6772C11.5823 21.4118 11.9423 21.2627 12.3176 21.2627H23.6397C24.015 21.2627 24.375 21.4118 24.6404 21.6772C24.9058 21.9427 25.0549 22.3026 25.0549 22.678C25.0549 23.0533 24.9058 23.4133 24.6404 23.6787C24.375 23.9441 24.015 24.0932 23.6397 24.0932H12.3176C11.9423 24.0932 11.5823 23.9441 11.3169 23.6787C11.0515 23.4133 10.9024 23.0533 10.9024 22.678C10.9024 22.3026 11.0515 21.9427 11.3169 21.6772Z" fill="#2F2F2F"/>
              </svg></a>
            </li>
            <li class="nav-item">
              <a class="nav-link active hvr-underline-from-left text-white fw-light fs-5" aria-current="page" href="./register.html"><svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 34 34" fill="none">
                <path d="M29.588 21.719L24.2364 30.4385C23.6487 31.4018 22.8487 32.2186 21.8972 32.8267C20.9457 33.4348 19.8679 33.8181 18.7457 33.9476C18.45 33.9826 18.1525 34.0001 17.8547 34C16.3302 33.9979 14.8435 33.5254 13.5984 32.6471C12.3116 33.6097 10.7221 34.0802 9.11786 33.9734C7.51362 33.8666 6.00074 33.1895 4.85335 32.0649C3.70596 30.9403 2.99995 29.4425 2.86324 27.843C2.72653 26.2434 3.16817 24.6478 4.10814 23.3453L2.24244 21.4853C1.44579 20.6898 0.839717 19.7246 0.469608 18.662C0.0994992 17.5995 -0.0250517 16.4671 0.105283 15.3497C0.235618 14.2322 0.61746 13.1587 1.22221 12.2096C1.82697 11.2604 2.63896 10.4601 3.59738 9.8687L11.7795 4.81691C13.9959 3.39853 16.6024 2.71085 19.2313 2.8509C21.8601 2.99095 24.3785 3.95167 26.4312 5.59749L28.785 3.24726C28.9159 3.11196 29.0724 3.00403 29.2455 2.92979C29.4186 2.85554 29.6048 2.81646 29.7932 2.81483C29.9815 2.81319 30.1684 2.84904 30.3427 2.92027C30.5171 2.9915 30.6755 3.09669 30.8087 3.2297C30.9419 3.36271 31.0473 3.52089 31.1186 3.69499C31.19 3.86909 31.2259 4.05563 31.2242 4.24374C31.2226 4.43184 31.1834 4.61773 31.1091 4.79057C31.0347 4.96341 30.9266 5.11973 30.7911 5.25041L28.4402 7.59922C30.017 9.57155 30.9685 11.9688 31.1729 14.4842C31.3774 16.9995 30.8256 19.5186 29.588 21.719ZM11.4361 30.6666L6.15969 25.3967C5.74736 26.133 5.58833 26.984 5.70699 27.8193C5.82565 28.6545 6.21544 29.4278 6.81659 30.0206C7.42301 30.5958 8.19433 30.9673 9.02264 31.0831C9.85095 31.1989 10.6948 31.0533 11.4361 30.6666ZM25.5119 8.5668C23.9364 6.9785 21.8624 5.9786 19.637 5.7344C17.4115 5.49019 15.1696 6.01648 13.2862 7.22523L5.08993 12.277C4.49552 12.6439 3.99194 13.1403 3.61689 13.729C3.24185 14.3178 3.00507 14.9836 2.92427 15.6767C2.84348 16.3697 2.92077 17.0721 3.15036 17.7311C3.37995 18.3901 3.75589 18.9887 4.25002 19.4821L14.5929 29.8109C15.0878 30.3057 15.6887 30.6819 16.3502 30.9114C17.0117 31.1409 17.7168 31.2176 18.4123 31.1358C19.1078 31.054 19.7757 30.8158 20.3657 30.4391C20.9557 30.0624 21.4525 29.557 21.8188 28.961L27.1463 20.2839C28.1868 18.4178 28.5902 16.264 28.2953 14.1486C28.0004 12.0331 27.0233 10.0711 25.5119 8.55972V8.5668ZM27.3265 34C27.0268 34.0005 26.7347 33.9064 26.492 33.7309C26.2493 33.5555 26.0684 33.3079 25.9753 33.0235C25.8822 32.7391 25.8817 32.4326 25.9738 32.1479C26.0659 31.8632 26.2459 31.615 26.488 31.4387C28.9723 29.5737 30.6536 26.8355 31.1912 23.7788C31.2289 23.5948 31.3029 23.4201 31.4088 23.2649C31.5148 23.1097 31.6505 22.9771 31.8083 22.8748C31.966 22.7725 32.1425 22.7025 32.3276 22.6689C32.5127 22.6354 32.7026 22.6389 32.8863 22.6792C33.07 22.7196 33.2438 22.7961 33.3976 22.9042C33.5515 23.0122 33.6823 23.1498 33.7824 23.3088C33.8825 23.4678 33.9499 23.6451 33.9808 23.8304C34.0116 24.0156 34.0053 24.2052 33.9621 24.388C33.2669 28.1161 31.1975 31.4487 28.1621 33.728C27.9194 33.9047 27.6268 33.9999 27.3265 34ZM1.41246 8.13047C1.15041 8.1293 0.89381 8.05569 0.671103 7.91781C0.448395 7.77992 0.268285 7.58314 0.150741 7.34928C0.0331976 7.11543 -0.0171862 6.85364 0.00517616 6.59294C0.0275385 6.33223 0.121773 6.08281 0.277432 5.87232C2.59143 2.78485 5.9977 0.694906 9.8017 0.028622C10.1705 -0.046522 10.554 0.0276808 10.868 0.234907C11.1819 0.442133 11.4006 0.765407 11.4759 1.13361C11.5511 1.50182 11.4768 1.88479 11.2693 2.19829C11.0617 2.51179 10.738 2.73012 10.3692 2.80526C7.24503 3.32039 4.44188 5.02322 2.54748 7.55672C2.41607 7.73397 2.24503 7.87814 2.04798 7.97774C1.85093 8.07735 1.63332 8.12965 1.41246 8.13047Z" fill="#2F2F2F"/>
              </svg></a>
            </li>
            <li class="nav-item">
              <img v-if="isLogged" :src="infoProfile.image" class="icon-nav" alt="hombre-profile">
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
  <!--Navbar End-->
</template>

<style scoped>

</style>